<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Analytics Dashboard - Astraea Scouting</title>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo2.png') }}">
  <link rel="stylesheet" href="/static/analytics.css">
</head>
<body>
  <div class="dashboard-container">
    <div class="header">
      <div class="header-left">
        <h1>📊 Scouting Analytics Dashboard</h1>
        <p class="header-subtitle">Comprehensive analysis of team performance and match data</p>
      </div>
      <div class="header-right">
        <a href="/admin" class="back-btn">← Back to Admin</a>
        <button class="refresh-btn" onclick="loadAnalyticsData()">🔄 Refresh Data</button>
      </div>
    </div>

    <div class="controls">
    <div class="control-group">
        <label for="event-filter">Event:</label>
        <select id="event-filter">
        <option value="">All Events</option>
        </select>
    </div>
    <div class="control-group">
        <label for="team-filter">Team:</label>
        <select id="team-filter">
        <option value="">All Teams</option>
        </select>
    </div>
    <div class="control-group">
        <label for="match-filter">Match Range:</label>
        <input type="number" id="match-min" placeholder="Min" min="1" style="width: 80px;">
        <span style="color: rgba(255, 255, 255, 0.9);">-</span>
        <input type="number" id="match-max" placeholder="Max" min="1" style="width: 80px;">
    </div>
    <div class="control-group">
        <label>
        <input type="checkbox" id="hide-partial-filter">
        Hide Partial Matches
        </label>
    </div>
    </div>

    <div class="analytics-tabs">
      <button class="tab-btn active" data-tab="overview">📈 Overview</button>
      <button class="tab-btn" data-tab="teams">🤖 Team Analysis</button>
      <button class="tab-btn" data-tab="matches">🏟 Match Details</button>
      <button class="tab-btn" data-tab="insights">🧠 Team Insights</button>
      <button class="tab-btn" data-tab="comparison">⚖️ Team Comparison</button>
    </div>

    <!-- Overview Tab -->
    <div id="overview" class="tab-content active">
      <div class="stats-grid" id="overview-stats">
        <div class="stat-card">
          <span class="stat-number" id="total-reports">-</span>
          <span class="stat-label">Total Reports</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="total-teams">-</span>
          <span class="stat-label">Teams Scouted</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="avg-auto-score">-</span>
          <span class="stat-label">Avg Auto Score</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="avg-teleop-score">-</span>
          <span class="stat-label">Avg Teleop Score</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="climb-success-rate">-</span>
          <span class="stat-label">Climb Success Rate</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="avg-offense-rating">-</span>
          <span class="stat-label">Avg Offense Rating</span>
        </div>
      </div>

      <div class="chart-container">
        <h3 class="chart-title">🎯 Scoring Distribution</h3>
        <canvas id="scoring-chart" width="400" height="200"></canvas>
      </div>

      <div class="chart-container">
        <h3 class="chart-title">🏆 Top Performing Teams</h3>
        <div id="top-teams-chart"></div>
      </div>
    </div>

    <!-- Team Analysis Tab -->
    <div id="teams" class="tab-content">
      <div class="chart-container">
        <h3 class="chart-title">🤖 Team Performance Analysis</h3>
        <div id="team-analysis-container">
          <div class="loading">Loading team data...</div>
        </div>
      </div>
    </div>

    <!-- Match Details Tab -->
    <div id="matches" class="tab-content">
      <div class="chart-container">
        <h3 class="chart-title">🏟 Recent Match Details</h3>
        <div id="match-details-container">
          <div class="loading">Loading match data...</div>
        </div>
      </div>
    </div>

    <!-- Team Insights Tab -->
    <div id="insights" class="tab-content">
      <div class="chart-container">
        <h3 class="chart-title">🧠 AI-Generated Team Insights</h3>
        <p style="color: #6b7280; margin-bottom: 20px; font-style: italic;">
          Algorithmic analysis of team performance patterns, consistency, and strategic focus based on match data.
        </p>
        <div id="team-insights-container">
          <div class="loading">Analyzing team data...</div>
        </div>
      </div>
    </div>

    <!-- Team Comparison Tab -->
    <div id="comparison" class="tab-content">
      <div class="controls">
        <div class="control-group">
          <label for="compare-team1">Team 1:</label>
          <select id="compare-team1">
            <option value="">Select Team</option>
          </select>
        </div>
        <div class="control-group">
          <label for="compare-team2">Team 2:</label>
          <select id="compare-team2">
            <option value="">Select Team</option>
          </select>
        </div>
        <button class="refresh-btn" onclick="compareTeams()">🔍 Compare</button>
      </div>

      <div class="chart-container">
        <h3 class="chart-title">⚖️ Head-to-Head Comparison</h3>
        <div id="comparison-container">
          <p class="loading">Select two teams to compare their performance</p>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/analytics.js"></script>
</body>
</html>